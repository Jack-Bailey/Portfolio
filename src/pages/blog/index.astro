---
import { getEntry, getEntries, getCollection } from 'astro:content';
import MainLayout from "../../layouts/Main.astro";
import TagChips from '../../components/blog/TagChips.astro';

let blogEntries = await getCollection('blog');

blogEntries = blogEntries.sort((a, b) => new Date(b.data.created) - new Date(a.data.created));


console.log(blogEntries.map((entry) => entry.data.title));

---

<MainLayout>
	<main>
		<h1>Recent Posts</h1>
		<div class="posts">
			{
				blogEntries.map((entry) => (
					<article>
						<a href={`/blog/posts/${entry.slug}`}>
							<h2>{entry.data.title}</h2>
							<p>{entry.data.description}</p>
						</a>
						<TagChips tags={entry.data.tags} />
					</article>
				))
			}
		</div>
	</main>
</MainLayout>

<style lang="scss">
	main {
		padding: 1rem;
		margin: 0 auto;
		width: 1000px;
		max-width: 90%;
		.posts {
			article + article {
				margin-top: 2rem;
			}
			article {
				display: block;
				border: 1px solid var(--foreground-2);
				border-radius: 1rem;
				padding: 1rem;
				a {
					text-decoration: none;
					color: inherit;
					h2 {
						margin: 0;
					}
					p {
						margin: 1rem 0 0 0;
					}
				}
				:global(.tags) {
					margin-top: 1rem;
				}
			}
		}
	}
</style>